type Token {
    id: ID!
    identity_id: ID!
}

type CreateTokenResponse {
    secret: Password!
    token: Token!
}

input CreateTokenRequest {
    identity_id: ID!
}

extend type Query {
    tokens(identity_id: ID!): [ID!]! @isAuthenticated()
}

extend type Mutation {
    createToken(input: CreateTokenRequest!): CreateTokenResponse! @isAuthenticated()
    removeToken(id: ID!): ID! @isAuthenticated()
}
